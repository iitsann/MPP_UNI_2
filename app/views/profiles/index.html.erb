<div class="container mt-4">
  <p class="text-success"><%= notice %></p>
  <h1>Profiles</h1>
  <div id="profiles" class="mt-3">
    <%= link_to "New profile", new_profile_path, class: "btn btn-success" %>
    <% if @profiles.any? %>
      <% if @profiles.count > 1 %>
        <% @profiles.each do |profile| %>
          <div class="card mb-3">
            <%= render profile %>
            <div class="card-body d-flex justify-content-between align-items-center">
              <%= link_to "Show this profile", profile, class: "btn btn-primary me-2" %>
              <%= link_to "All user's posts", user_posts_path(profile.user), class: "btn btn-info me-2" %>
              <% if current_user && current_user.profile && current_user.profile.id != profile.id %>
                <%= button_to create_chat_profile_path(profile), method: :post, class: "btn btn-danger" do %>
                  Chat
                <% end %>
              <% end %>
            </div>
          </div>
        <% end %>
      <% else %>
        <p>Chat is not available. You need at least two profiles to start chatting.</p>
      <% end %>
    <% else %>
      <p>No profiles available.</p>
    <% end %>
  </div>
</div>
